# ---- Load libraries ----
library(tidyverse)

# ---- Load data ----
# VI MSOA
vi_msoa <- read_csv("https://raw.githubusercontent.com/britishredcrosssociety/covid-19-vulnerability/master/output/vulnerability-MSOA-UK.csv")

# VI LA
vi_la <- read_csv("https://raw.githubusercontent.com/britishredcrosssociety/covid-19-vulnerability/master/output/vulnerability-LA.csv")

# ---- Clean data -----
# - MSOA -
vi_msoa_clean <-
  vi_msoa %>% 
  select(MSOA11CD = Code,
         MSOA11NM = Name,
         ends_with("decile"),
         ends_with("rank"))

vi_la_clean <-
  vi_la %>% 
  select(LAD19CD = Code,
         LAD19NM = Name,
         ends_with("quintile"),
         starts_with("Extent"),
         ends_with("rank"))

# ---- Save to curated ----
vi_msoa_clean %>% 
  write_csv("data/processed/vulnerability index - msoa.csv")

vi_la_clean %>% 
  write_csv("data/processed/vulnerability - index - la.csv")
