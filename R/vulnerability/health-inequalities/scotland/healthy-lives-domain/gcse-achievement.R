library(readr)
library(httr)
library(dplyr)

# Source:https://scotland.shinyapps.io/ScotPHO_profiles_tool/
GET(
  "https://scotland.shinyapps.io/ScotPHO_profiles_tool/_w_780d97de/session/555592882a2c06fe7edb966cd746b9a7/download/download_table_csv?w=780d97de",
  write_disk(tf <- tempfile(fileext = ".csv"))
)

gcse_raw <-
  read_csv(tf)

unlink(tf)
rm(tf)

gcse_achievement <-
  gcse_raw %>%
  filter(area_type == "Council area") %>%
  select(
    lad_code = area_code,
    gcse_qualifications_percent = measure
  )

# Note: S12000013 scores 0. Impute mean or neighbour average?